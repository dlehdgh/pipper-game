function gameScore(){let e=new Array(4).fill(0);e=tile.map(e=>e.map(e=>e<=5?5:e<=10?10:e<=15?15:16==e?30:0).reduce((e,i)=>e+i,0)),e[pipper.priority]=300,$.each(e,(i,p)=>{i!=pipper.priority&&(e[pipper.priority]+=p,e[i]=300-p)}),e=e.map((e,i)=>new Object({name:person[i],value:e})).sort((e,i)=>i.value-e.value),$("#score-board ul").empty(),$.each(e,(e,i)=>{$("#score-board ul").append(`<li class="list-group-item" data-value="${e}"><span><i class="fa fa-user text-danger" aria-hidden="true"></i> ${i.name}</span><span class="badge">${i.value}점</span></li>`)}),$("#score-board").modal({backdrop:"static",keyboard:!1}).focus()}class Map{constructor(e){this.tile=e,this.fragment=$(document.createDocumentFragment())}create(){let e=new Array(64).fill(0).map((e,i)=>Math.floor(i/4)+1).mix();tile=new Array(4).fill(0).map(i=>e.splice(0,16)).mix2D(),$.each(tile[3],(e,i)=>{this.fragment.append(`<button type="button" class="btn btn-tile" data-value="${i}">${xTile(i)}</button>`)}),"GAME_READY"==GameStatus&&this.fragment.find(".btn-tile").css("visibility","hidden"),$("#board").html(this.fragment)}print(){let e,i=new Tile(this.tile.value()).info();0==this.tile.length?(i.name="패스",e=`${person[pipper.priority]}님이 패스했습니다.`):("GAME_MINE"==GameStatus||"GAME_RETURN"==GameStatus?(e=`${i.name}으로 ${person[pipper.priority]}님이 선입니다.`,pipper.prev=new Array):e=`${person[pipper.priority]}님이 버린 패는 ${i.name}입니다.`,$(".abandon, .message").empty(),$.each(this.tile,(e,i)=>{$("#prev_tile .abandon").append(`<span class="btn btn-tile btn-lg" data-value="${i.value}">${xTile(i.value)}</span>`),delete tile[pipper.priority][i.index]}),$("#prev_tile .message").text(`${person[pipper.priority]} : ${i.name}`)),console.log(person[pipper.priority],":",i.name),new MsgBox(e).fadeSpeak(function(){let e=tile.map(e=>e.filter(e=>e>=0).length);1==e.includes(0)?((new Timer).clear(),3==pipper.priority?(soundTo.play("winner.wav",!1,gameScore),new MsgBox(`축하합니다! ${person[pipper.priority]}님이 이겼습니다.`).fadeIn()):(soundTo.play("loser.wav",!1,gameScore),new MsgBox(`다음 기회를 노리세요! ${person[pipper.priority]}님이 이겼습니다.`).fadeIn())):0==this.tile.length?new Next("GAME_BASIC").play():e[pipper.priority]<6?(console.log(`${person[pipper.priority]} : 패가 ${e[pipper.priority]}개 남음`),new MsgBox(`${person[pipper.priority]}님의 패가 ${e[pipper.priority]}개 남았습니다.`).fadeSpeak(function(){new HasTile(i,this.tile[0].value).init()}.bind(this))):new HasTile(i,this.tile[0].value).init()}.bind(this)),$("#history").prepend(`<li class="list-group-item">${person[pipper.priority]} : ${i.name}</li>`)}}